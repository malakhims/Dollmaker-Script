function toggleFullScreen(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}function prepareDoll(e){$(e).find("#bodyArea, #piecesArea div").css({"background-color":"transparent",border:"0","border-radius":"0"})}!function(e){e.fn.invisible=function(){return this.each(function(){e(this).css({visibility:"hidden",display:""})})},e.fn.visible=function(){return this.each(function(){e(this).removeAttr("style")})}}(jQuery),$(function(){$("#piecesArea img").draggable({stack:".ui-draggable",distance:0,containment:"document"}),$("#bodyArea").droppable({accept:".ui-draggable",tolerance:"touch",drop:function(e,t){t.draggable.css("visibility","visible")},out:function(e,t){t.draggable.css("visibility","");var n=t.draggable.parent().index()-1;$("#piecesArea").tabs({active:n})}}),$("#piecesArea").tabs({activate:function(e,t){t.oldPanel.invisible(),t.newPanel.visible()}}),$("#instrBtn").on("click",function(){$("#instructions").slideToggle()}),$("#swatchesArea a").on("click",function(e){for(var t,n,i=$(this).attr("href"),l=$(this).parent().attr("id"),a=(n=(t=i).substr(t.lastIndexOf("/")+1)).substr(0,n.lastIndexOf(".")).replace(/\.[^/.]+$/,"").replace("-slash-","/").replace("``",'"').replace("`","'"),o=document.getElementsByClassName("switcher"),r=document.getElementsByClassName("clickable"),c=Array.from(o),s=Array.from(r),d=0;d<c.length;d++){let f=$(c[d]).attr("id"),u=$(s[d]);l===f&&$(u).attr({src:i,alt:a,title:a}),e.preventDefault()}}),$("#reset").on("click",function(){location.reload(!0),window.location.reload()});let e=document.getElementById("bodyArea"),t=e.offsetWidth,n=e.offsetHeight,i=e.offsetLeft,l=e.offsetTop;$("#downloadDoll").on("click",function(){html2canvas(document.querySelector("#dollmaker_container"),{onclone:function(e){prepareDoll(e)},backgroundColor:null,allowTaint:!0,useCORS:!0,width:t,height:n,scale:1,imageSmoothingEnabled:!1,x:i,y:l}).then(e=>{e.toBlob(function(t){try{window.saveAs(t,"my_doll.png",e.toDataURL("image/png"))}catch(n){alert(n)}})})});let a=document.querySelector("#avi-area"),o=a.offsetWidth,r=a.offsetHeight,c=i+a.offsetLeft,s=l+a.offsetTop;$("#downloadAvi").on("click",function(){html2canvas(document.querySelector("#dollmaker_container"),{onclone:function(e){prepareDoll(e)},backgroundColor:null,allowTaint:!0,width:o,height:r,x:c,y:s,scale:1,imageSmoothingEnabled:!1}).then(e=>{e.toBlob(function(t){try{window.saveAs(t,"my_doll_avi.png",e.toDataURL("image/png"))}catch(n){alert(n)}})})})});